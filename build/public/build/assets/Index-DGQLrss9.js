import{r as o,j as e,Q as I,t as m,S as g}from"./app-DQ50vfdB.js";import{T as A}from"./TailLayout-CUFZkN9l.js";import{F as M}from"./PlusIcon-BOT5okp5.js";import{F as E}from"./DocumentTextIcon-WQjWO2mO.js";import{F as L}from"./ClockIcon-Bw5Yb6Dk.js";import{F as B}from"./CheckCircleIcon-DZlEFXlT.js";import{F as H}from"./XCircleIcon-DoQwDPxr.js";import{F as K}from"./MagnifyingGlassIcon-BUKtBMH4.js";import{F as J}from"./EyeIcon-DfYgRoOc.js";import{F as Q,a as z}from"./TrashIcon-Cjx8d98D.js";import"./TechStackBackground-vFG2YikW.js";import"./index-CXCxKWl8.js";import"./XMarkIcon-iLJawDXb.js";import"./UsersIcon-Do4GODTd.js";import"./transition-B40-nL65.js";import"./dialog-B4S7MQxj.js";import"./with-selector-CC73ae-U.js";import"./index-OSMIWnHG.js";function ce({pinjaman:s,search:w="",status:k="",auth:n}){var f,j;const[u,v]=o.useState(w),[i,D]=o.useState(k),[S,h]=o.useState(!1),[d,p]=o.useState(null),F=t=>{t.preventDefault(),g.get("/pinjaman",{search:u,status:i},{preserveState:!0})},x=t=>{D(t),g.get("/pinjaman",{search:u,status:t},{preserveState:!0})},$=t=>{p(t),h(!0)},_=()=>{d&&g.delete(`/pinjaman/${d.id}`,{onSuccess:()=>{h(!1),p(null)}})},C=t=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(t),R=t=>new Date(t).toLocaleDateString("id-ID"),P=t=>{const a={diajukan:"bg-blue-100 text-blue-800",diperiksa:"bg-yellow-100 text-yellow-800",dikembalikan:"bg-red-100 text-red-800",dianalisis:"bg-purple-100 text-purple-800",siap_diputuskan:"bg-indigo-100 text-indigo-800",disetujui:"bg-green-100 text-green-800",ditolak:"bg-red-100 text-red-800"},r={diajukan:"Diajukan",diperiksa:"Diperiksa",dikembalikan:"Dikembalikan",dianalisis:"Dianalisis",siap_diputuskan:"Siap Diputuskan",disetujui:"Disetujui",ditolak:"Ditolak"};return e.jsx("span",{className:`inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium ${a[t]||"bg-gray-100 text-gray-800"}`,children:r[t]||t})},c=(()=>{var a,r;const t={total:((a=s==null?void 0:s.meta)==null?void 0:a.total)||0,diajukan:0,disetujui:0,ditolak:0,proses:0};return(r=s==null?void 0:s.data)==null||r.forEach(l=>{l.status==="diajukan"?t.diajukan++:l.status==="disetujui"?t.disetujui++:l.status==="ditolak"?t.ditolak++:t.proses++}),t})(),T=t=>{const a=n.user.role,r=t.status;return a==="admin"||a==="staf_input"&&r==="diajukan"||a==="admin_kredit"&&r==="diperiksa"||a==="analis"&&r==="dianalisis"||a==="pemutus"&&r==="siap_diputuskan"};return e.jsxs(A,{children:[e.jsx(I,{title:"Data Pinjaman"}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Data Pinjaman"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Kelola pinjaman nasabah berdasarkan workflow"})]}),n.user.role==="staf_input"&&e.jsxs(m,{href:"/pinjaman/create",className:"inline-flex items-center rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-700",children:[e.jsx(M,{className:"mr-2 h-5 w-5"}),"Tambah Pinjaman"]})]}),e.jsxs("div",{className:"mb-6 grid grid-cols-1 gap-4 sm:grid-cols-4",children:[e.jsx("div",{className:"rounded-lg bg-white p-6 shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(E,{className:"h-8 w-8 text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Pinjaman"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:c.total})]})]})}),e.jsx("div",{className:"rounded-lg bg-white p-6 shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(L,{className:"h-8 w-8 text-yellow-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Diajukan"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:c.diajukan})]})]})}),e.jsx("div",{className:"rounded-lg bg-white p-6 shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(B,{className:"h-8 w-8 text-green-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Disetujui"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:c.disetujui})]})]})}),e.jsx("div",{className:"rounded-lg bg-white p-6 shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(H,{className:"h-8 w-8 text-red-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Ditolak"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:c.ditolak})]})]})})]}),e.jsxs("div",{className:"mb-6 flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("form",{onSubmit:F,className:"flex w-full max-w-md gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(K,{className:"absolute left-3 top-1/2 h-5 w-5 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",value:u,onChange:t=>v(t.target.value),placeholder:"Cari nama nasabah, NIK...",className:"w-full rounded-lg border border-gray-300 py-2 pl-10 pr-4 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),e.jsx("button",{type:"submit",className:"rounded-lg bg-gray-100 px-4 py-2 text-gray-700 hover:bg-gray-200",children:"Cari"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>x(""),className:`rounded-lg px-3 py-2 text-sm font-medium ${i===""?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Semua"}),e.jsx("button",{onClick:()=>x("diajukan"),className:`rounded-lg px-3 py-2 text-sm font-medium ${i==="diajukan"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Diajukan"}),e.jsx("button",{onClick:()=>x("disetujui"),className:`rounded-lg px-3 py-2 text-sm font-medium ${i==="disetujui"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Disetujui"}),e.jsx("button",{onClick:()=>x("ditolak"),className:`rounded-lg px-3 py-2 text-sm font-medium ${i==="ditolak"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Ditolak"})]})]}),e.jsx("div",{className:"overflow-hidden rounded-lg bg-white shadow",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Nasabah"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Jumlah Pinjaman"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Penanggung Jawab"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Tanggal Pengajuan"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500",children:"Aksi"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:s!=null&&s.data&&s.data.length>0?s.data.map(t=>{var a,r,l,b,y,N;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"whitespace-nowrap px-6 py-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:((a=t.nasabah)==null?void 0:a.nama)||"N/A"}),e.jsxs("div",{className:"text-sm text-gray-500",children:["NIK: ",((r=t.nasabah)==null?void 0:r.nik)||"N/A"]})]}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-gray-900",children:C(t.jumlah_pinjaman)}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4",children:P(t.status)}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-gray-900",children:((l=t.staf_input)==null?void 0:l.name)||((b=t.admin_kredit)==null?void 0:b.name)||((y=t.analis)==null?void 0:y.name)||((N=t.pemutus)==null?void 0:N.name)||"-"}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-gray-500",children:R(t.created_at)}),e.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-right text-sm font-medium",children:e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(m,{href:`/pinjaman/${t.id}`,className:"text-blue-600 hover:text-blue-900",children:e.jsx(J,{className:"h-5 w-5"})}),T(t)&&e.jsx(m,{href:`/pinjaman/${t.id}/edit`,className:"text-indigo-600 hover:text-indigo-900",children:e.jsx(Q,{className:"h-5 w-5"})}),(n.user.role==="admin"||n.user.role==="staf_input")&&e.jsx("button",{onClick:()=>$(t),className:"text-red-600 hover:text-red-900",children:e.jsx(z,{className:"h-5 w-5"})})]})})]},t.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-4 text-center text-sm text-gray-500",children:"Belum ada data pinjaman"})})})]})})}),((f=s==null?void 0:s.meta)==null?void 0:f.last_page)>1&&e.jsxs("div",{className:"mt-6 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Menampilkan"," ",(s.meta.current_page-1)*s.meta.per_page+1," -"," ",Math.min(s.meta.current_page*s.meta.per_page,s.meta.total)," ","dari ",s.meta.total," data"]}),e.jsx("div",{className:"flex space-x-1",children:s.links.map((t,a)=>e.jsx(m,{href:t.url||"#",className:`px-3 py-2 text-sm ${t.active?"bg-blue-600 text-white":"bg-white text-gray-500 hover:bg-gray-100"} border border-gray-300 ${a===0?"rounded-l-lg":""} ${a===s.links.length-1?"rounded-r-lg":""}`,dangerouslySetInnerHTML:{__html:t.label}},a))})]})]}),S&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"w-full max-w-md rounded-lg bg-white p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Hapus Pinjaman"}),e.jsxs("p",{className:"mt-2 text-sm text-gray-500",children:["Apakah Anda yakin ingin menghapus pinjaman untuk nasabah"," ",e.jsx("strong",{children:(j=d==null?void 0:d.nasabah)==null?void 0:j.nama}),"? Tindakan ini tidak dapat dibatalkan."]}),e.jsxs("div",{className:"mt-4 flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>h(!1),className:"rounded-lg border border-gray-300 px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Batal"}),e.jsx("button",{onClick:_,className:"rounded-lg bg-red-600 px-4 py-2 text-sm font-medium text-white hover:bg-red-700",children:"Hapus"})]})]})})]})}export{ce as default};
